[supervisord]
nodaemon=true
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
user=root

# =============================================================================
# VNC Server - Display :1, Port 5901
# =============================================================================
[program:xtigervnc]
command=/usr/bin/Xtigervnc :1 -geometry 1280x720 -depth 24 -rfbport 5901 -rfbauth /home/browseruser/.vnc/passwd -SecurityTypes VncAuth -localhost no
user=browseruser
environment=HOME="/home/browseruser"
autorestart=true
priority=10
stdout_logfile=/var/log/supervisor/vnc.log
stderr_logfile=/var/log/supervisor/vnc-error.log

# =============================================================================
# Fluxbox Window Manager
# =============================================================================
[program:fluxbox]
command=/usr/bin/fluxbox
user=browseruser
environment=DISPLAY=":1",HOME="/home/browseruser"
autorestart=true
priority=20
startsecs=3
stdout_logfile=/var/log/supervisor/fluxbox.log
stderr_logfile=/var/log/supervisor/fluxbox-error.log

# =============================================================================
# API Express - Port 3001
# =============================================================================
[program:api-server]
command=node /app/src/api.js
user=browseruser
directory=/app
environment=DISPLAY=":1",HOME="/home/browseruser",NODE_ENV="production"
autorestart=true
priority=30
startsecs=5
stdout_logfile=/var/log/supervisor/api-server.log
stderr_logfile=/var/log/supervisor/api-server-error.log
